import r,{createContext as t,useState as e,useCallback as n,useRef as i,useContext as o,useEffect as s}from"react";var a=function(){return(a=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i]);return r}).apply(this,arguments)};var c=t(null);function f(r,t){var e,n;if("function"==typeof t)void 0!==(n=t(r))&&(r=n);else if(Array.isArray(t))for(e=0;e<t.length;e++)void 0!==(n=t[e](r))&&(r=n);return r}function u(r,t){return"-"===r[0]&&Array.isArray(t)&&/^-\d+$/.test(r)?t.length+parseInt(r,10):r}function p(r){return"[object Object]"===Object.prototype.toString.call(r)}function h(r){return Object(r)===r}function l(r){return 0===Object.keys(r).length}function y(r,t){return r.indexOf("[")>=0&&(r=r.replace(/\[/g,".").replace(/]/g,"")),r.split(t)}var v=Object.prototype.hasOwnProperty;function d(r,t,e,n){if(!(this instanceof d))return new d(r,t,e,n);void 0===t&&(t=!1),void 0===e&&(e=!0),void 0===n&&(n=!0),this.separator=r||".",this.override=t,this.useArray=e,this.useBrackets=n,this.keepArray=!1,this.cleanup=[]}var A=new d(".",!1,!0,!0);function g(r){return function(){return A[r].apply(A,arguments)}}d.prototype._fill=function(r,t,e,n){var i=r.shift();if(r.length>0){if(t[i]=t[i]||(this.useArray&&function(r){return/^\d+$/.test(r)}(r[0])?[]:{}),!h(t[i])){if(!this.override){if(!h(e)||!l(e))throw new Error("Trying to redefine `"+i+"` which is a "+typeof t[i]);return}t[i]={}}this._fill(r,t[i],e,n)}else{if(!this.override&&h(t[i])&&!l(t[i])){if(!h(e)||!l(e))throw new Error("Trying to redefine non-empty obj['"+i+"']");return}t[i]=f(e,n)}},d.prototype.object=function(r,t){var e=this;return Object.keys(r).forEach(function(n){var i=void 0===t?null:t[n],o=y(n,e.separator).join(e.separator);-1!==o.indexOf(e.separator)?(e._fill(o.split(e.separator),r,r[n],i),delete r[n]):r[n]=f(r[n],i)}),r},d.prototype.str=function(r,t,e,n){var i=y(r,this.separator).join(this.separator);return-1!==r.indexOf(this.separator)?this._fill(i.split(this.separator),e,t,n):e[r]=f(t,n),e},d.prototype.pick=function(r,t,e,n){var i,o,s,a,c;for(o=y(r,this.separator),i=0;i<o.length;i++){if(a=u(o[i],t),!(t&&"object"==typeof t&&a in t))return;if(i===o.length-1)return e?(s=t[a],n&&Array.isArray(t)?t.splice(a,1):delete t[a],Array.isArray(t)&&(c=o.slice(0,-1).join("."),-1===this.cleanup.indexOf(c)&&this.cleanup.push(c)),s):t[a];t=t[a]}return e&&Array.isArray(t)&&(t=t.filter(function(r){return void 0!==r})),t},d.prototype.delete=function(r,t){return this.remove(r,t,!0)},d.prototype.remove=function(r,t,e){var n;if(this.cleanup=[],Array.isArray(r)){for(n=0;n<r.length;n++)this.pick(r[n],t,!0,e);return e||this._cleanup(t),t}return this.pick(r,t,!0,e)},d.prototype._cleanup=function(r){var t,e,n,i;if(this.cleanup.length){for(e=0;e<this.cleanup.length;e++)t=(t=(i=(n=this.cleanup[e].split(".")).splice(0,-1).join("."))?this.pick(i,r):r)[n[0]].filter(function(r){return void 0!==r}),this.set(this.cleanup[e],t,r);this.cleanup=[]}},d.prototype.del=d.prototype.remove,d.prototype.move=function(r,t,e,n,i){return"function"==typeof n||Array.isArray(n)?this.set(t,f(this.pick(r,e,!0),n),e,i):(i=n,this.set(t,this.pick(r,e,!0),e,i)),e},d.prototype.transfer=function(r,t,e,n,i,o){return"function"==typeof i||Array.isArray(i)?this.set(t,f(this.pick(r,e,!0),i),n,o):(o=i,this.set(t,this.pick(r,e,!0),n,o)),n},d.prototype.copy=function(r,t,e,n,i,o){return"function"==typeof i||Array.isArray(i)?this.set(t,f(JSON.parse(JSON.stringify(this.pick(r,e,!1))),i),n,o):(o=i,this.set(t,this.pick(r,e,!1),n,o)),n},d.prototype.set=function(r,t,e,n){var i,o,s,a;if(void 0===t)return e;for(s=y(r,this.separator),i=0;i<s.length;i++){if(a=s[i],i===s.length-1)if(n&&p(t)&&p(e[a]))for(o in t)v.call(t,o)&&(e[a][o]=t[o]);else if(n&&Array.isArray(e[a])&&Array.isArray(t))for(var c=0;c<t.length;c++)e[s[i]].push(t[c]);else e[a]=t;else v.call(e,a)&&(p(e[a])||Array.isArray(e[a]))||(/^\d+$/.test(s[i+1])?e[a]=[]:e[a]={});e=e[a]}return e},d.prototype.transform=function(r,t,e){return t=t||{},e=e||{},Object.keys(r).forEach(function(n){this.set(r[n],this.pick(n,t),e)}.bind(this)),e},d.prototype.dot=function(r,t,e){t=t||{},e=e||[];var n=Array.isArray(r);return Object.keys(r).forEach(function(i){var o=n&&this.useBrackets?"["+i+"]":i;if(h(r[i])&&(p(r[i])&&!l(r[i])||Array.isArray(r[i])&&!this.keepArray&&0!==r[i].length)){if(n&&this.useBrackets){var s=e[e.length-1]||"";return this.dot(r[i],t,e.slice(0,-1).concat(s+o))}return this.dot(r[i],t,e.concat(o))}n&&this.useBrackets?t[e.join(this.separator).concat("["+i+"]")]=r[i]:t[e.concat(o).join(this.separator)]=r[i]}.bind(this)),t},d.pick=g("pick"),d.move=g("move"),d.transfer=g("transfer"),d.transform=g("transform"),d.copy=g("copy"),d.object=g("object"),d.str=g("str"),d.set=g("set"),d.delete=g("delete"),d.del=d.remove=g("remove"),d.dot=g("dot"),["override","overwrite"].forEach(function(r){Object.defineProperty(d,r,{get:function(){return A.override},set:function(r){A.override=!!r}})}),["useArray","keepArray","useBrackets"].forEach(function(r){Object.defineProperty(d,r,{get:function(){return A[r]},set:function(t){A[r]=t}})}),d._process=f;var j=d,k=function(t){var i=e([]),o=i[0],s=i[1],a=n(function(r,t){s(function(e){return function(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;var n=Array(r),i=0;for(t=0;t<e;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}(e,[{name:r,ref:t}])})},[]);return r.createElement("form",{onSubmit:function(r){return function(r,e){r.preventDefault();var n={};return e.forEach(function(r){var t=r.name,e=r.ref;n[t]=e.value||""}),j.object(n),t.onSubmit(n)}(r,o)}},r.createElement(c.Provider,{value:{registerField:a}},t.children))},m=function(t){var e=i(),n=o(c).registerField;return s(function(){e.current&&n(t.name,e.current)},[t.name,n]),r.createElement("input",a({},t,{ref:e}))};export{k as Form,m as Input};
//# sourceMappingURL=index.es.js.map
