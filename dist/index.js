"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),React__default=_interopDefault(React),__assign=function(){return(__assign=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function __spreadArrays(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<r;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,n++)o[n]=i[s];return o}var FormContext=React.createContext(null);function _process(t,e){var r,o;if("function"==typeof e)void 0!==(o=e(t))&&(t=o);else if(Array.isArray(e))for(r=0;r<e.length;r++)void 0!==(o=e[r](t))&&(t=o);return t}function parseKey(t,e){return"-"===t[0]&&Array.isArray(e)&&/^-\d+$/.test(t)?e.length+parseInt(t,10):t}function isIndex(t){return/^\d+$/.test(t)}function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}function isArrayOrObject(t){return Object(t)===t}function isEmptyObject(t){return 0===Object.keys(t).length}function parsePath(t,e){return t.indexOf("[")>=0&&(t=t.replace(/\[/g,".").replace(/]/g,"")),t.split(e)}var hasOwnProperty=Object.prototype.hasOwnProperty;function DotObject(t,e,r,o){if(!(this instanceof DotObject))return new DotObject(t,e,r,o);void 0===e&&(e=!1),void 0===r&&(r=!0),void 0===o&&(o=!0),this.separator=t||".",this.override=e,this.useArray=r,this.useBrackets=o,this.keepArray=!1,this.cleanup=[]}var dotDefault=new DotObject(".",!1,!0,!0);function wrap(t){return function(){return dotDefault[t].apply(dotDefault,arguments)}}DotObject.prototype._fill=function(t,e,r,o){var n=t.shift();if(t.length>0){if(e[n]=e[n]||(this.useArray&&isIndex(t[0])?[]:{}),!isArrayOrObject(e[n])){if(!this.override){if(!isArrayOrObject(r)||!isEmptyObject(r))throw new Error("Trying to redefine `"+n+"` which is a "+typeof e[n]);return}e[n]={}}this._fill(t,e[n],r,o)}else{if(!this.override&&isArrayOrObject(e[n])&&!isEmptyObject(e[n])){if(!isArrayOrObject(r)||!isEmptyObject(r))throw new Error("Trying to redefine non-empty obj['"+n+"']");return}e[n]=_process(r,o)}},DotObject.prototype.object=function(t,e){var r=this;return Object.keys(t).forEach(function(o){var n=void 0===e?null:e[o],i=parsePath(o,r.separator).join(r.separator);-1!==i.indexOf(r.separator)?(r._fill(i.split(r.separator),t,t[o],n),delete t[o]):t[o]=_process(t[o],n)}),t},DotObject.prototype.str=function(t,e,r,o){var n=parsePath(t,this.separator).join(this.separator);return-1!==t.indexOf(this.separator)?this._fill(n.split(this.separator),r,e,o):r[t]=_process(e,o),r},DotObject.prototype.pick=function(t,e,r,o){var n,i,s,a,c;for(i=parsePath(t,this.separator),n=0;n<i.length;n++){if(a=parseKey(i[n],e),!(e&&"object"==typeof e&&a in e))return;if(n===i.length-1)return r?(s=e[a],o&&Array.isArray(e)?e.splice(a,1):delete e[a],Array.isArray(e)&&(c=i.slice(0,-1).join("."),-1===this.cleanup.indexOf(c)&&this.cleanup.push(c)),s):e[a];e=e[a]}return r&&Array.isArray(e)&&(e=e.filter(function(t){return void 0!==t})),e},DotObject.prototype.delete=function(t,e){return this.remove(t,e,!0)},DotObject.prototype.remove=function(t,e,r){var o;if(this.cleanup=[],Array.isArray(t)){for(o=0;o<t.length;o++)this.pick(t[o],e,!0,r);return r||this._cleanup(e),e}return this.pick(t,e,!0,r)},DotObject.prototype._cleanup=function(t){var e,r,o,n;if(this.cleanup.length){for(r=0;r<this.cleanup.length;r++)e=(e=(n=(o=this.cleanup[r].split(".")).splice(0,-1).join("."))?this.pick(n,t):t)[o[0]].filter(function(t){return void 0!==t}),this.set(this.cleanup[r],e,t);this.cleanup=[]}},DotObject.prototype.del=DotObject.prototype.remove,DotObject.prototype.move=function(t,e,r,o,n){return"function"==typeof o||Array.isArray(o)?this.set(e,_process(this.pick(t,r,!0),o),r,n):(n=o,this.set(e,this.pick(t,r,!0),r,n)),r},DotObject.prototype.transfer=function(t,e,r,o,n,i){return"function"==typeof n||Array.isArray(n)?this.set(e,_process(this.pick(t,r,!0),n),o,i):(i=n,this.set(e,this.pick(t,r,!0),o,i)),o},DotObject.prototype.copy=function(t,e,r,o,n,i){return"function"==typeof n||Array.isArray(n)?this.set(e,_process(JSON.parse(JSON.stringify(this.pick(t,r,!1))),n),o,i):(i=n,this.set(e,this.pick(t,r,!1),o,i)),o},DotObject.prototype.set=function(t,e,r,o){var n,i,s,a;if(void 0===e)return r;for(s=parsePath(t,this.separator),n=0;n<s.length;n++){if(a=s[n],n===s.length-1)if(o&&isObject(e)&&isObject(r[a]))for(i in e)hasOwnProperty.call(e,i)&&(r[a][i]=e[i]);else if(o&&Array.isArray(r[a])&&Array.isArray(e))for(var c=0;c<e.length;c++)r[s[n]].push(e[c]);else r[a]=e;else hasOwnProperty.call(r,a)&&(isObject(r[a])||Array.isArray(r[a]))||(/^\d+$/.test(s[n+1])?r[a]=[]:r[a]={});r=r[a]}return r},DotObject.prototype.transform=function(t,e,r){return e=e||{},r=r||{},Object.keys(t).forEach(function(o){this.set(t[o],this.pick(o,e),r)}.bind(this)),r},DotObject.prototype.dot=function(t,e,r){e=e||{},r=r||[];var o=Array.isArray(t);return Object.keys(t).forEach(function(n){var i=o&&this.useBrackets?"["+n+"]":n;if(isArrayOrObject(t[n])&&(isObject(t[n])&&!isEmptyObject(t[n])||Array.isArray(t[n])&&!this.keepArray&&0!==t[n].length)){if(o&&this.useBrackets){var s=r[r.length-1]||"";return this.dot(t[n],e,r.slice(0,-1).concat(s+i))}return this.dot(t[n],e,r.concat(i))}o&&this.useBrackets?e[r.join(this.separator).concat("["+n+"]")]=t[n]:e[r.concat(i).join(this.separator)]=t[n]}.bind(this)),e},DotObject.pick=wrap("pick"),DotObject.move=wrap("move"),DotObject.transfer=wrap("transfer"),DotObject.transform=wrap("transform"),DotObject.copy=wrap("copy"),DotObject.object=wrap("object"),DotObject.str=wrap("str"),DotObject.set=wrap("set"),DotObject.delete=wrap("delete"),DotObject.del=DotObject.remove=wrap("remove"),DotObject.dot=wrap("dot"),["override","overwrite"].forEach(function(t){Object.defineProperty(DotObject,t,{get:function(){return dotDefault.override},set:function(t){dotDefault.override=!!t}})}),["useArray","keepArray","useBrackets"].forEach(function(t){Object.defineProperty(DotObject,t,{get:function(){return dotDefault[t]},set:function(e){dotDefault[t]=e}})}),DotObject._process=_process;var dotObject=DotObject,Form=function(t){var e=React.useState([]),r=e[0],o=e[1],n=React.useCallback(function(t,e){o(function(r){return __spreadArrays(r,[{name:t,ref:e}])})},[]);return React__default.createElement("form",{onSubmit:function(e){return function(e,r){e.preventDefault();var o={};return r.forEach(function(t){var e=t.name,r=t.ref;o[e]=r.value||""}),dotObject.object(o),t.onSubmit(o)}(e,r)}},React__default.createElement(FormContext.Provider,{value:{registerField:n}},t.children))},Input=function(t){var e=React.useRef(),r=React.useContext(FormContext).registerField;return React.useEffect(function(){e.current&&r(t.name,e.current)},[t.name,r]),React__default.createElement("input",__assign({},t,{ref:e}))};exports.Form=Form,exports.Input=Input;
//# sourceMappingURL=index.js.map
